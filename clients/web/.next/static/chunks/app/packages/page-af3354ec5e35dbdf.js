(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[547],{4280:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(2898).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},296:function(e,t,a){Promise.resolve().then(a.bind(a,5709))},5709:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var n=a(7437),s=a(2265),i=a(6652),r=a(8476),l=a(8222),c=a(2898);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,c.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var o=a(4280);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,c.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function p(){let[e,t]=(0,s.useState)([]),[a,c]=(0,s.useState)(!0),[p,x]=(0,s.useState)(""),[g,m]=(0,s.useState)("all"),[f,v]=(0,s.useState)(!1);async function y(){try{c(!0);let e=await (0,l.ZS)(100);t(e)}catch(e){console.error("Failed to load packages:",e)}finally{c(!1)}}(0,s.useEffect)(()=>{y()},[]);let j=e.filter(e=>{let t=e.package_id.toLowerCase().includes(p.toLowerCase())||e.ocr_text.toLowerCase().includes(p.toLowerCase()),a="all"===g||e.status===g;return t&&a});return(0,n.jsxs)("div",{className:"layout",children:[(0,n.jsx)(i.Z,{active:"packages"}),(0,n.jsxs)("main",{className:"main-content",children:[(0,n.jsxs)("div",{className:"page-header",children:[(0,n.jsx)("h1",{className:"page-title",children:"Packages"}),(0,n.jsx)("p",{className:"page-description",children:"Manage all ingested packages and their processing status"})]}),(0,n.jsx)("div",{className:"card",style:{marginBottom:"24px"},children:(0,n.jsxs)("div",{style:{display:"flex",gap:"16px",alignItems:"center",flexWrap:"wrap"},children:[(0,n.jsx)("div",{style:{flex:1,minWidth:"250px"},children:(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)(d,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),(0,n.jsx)("input",{type:"text",className:"input",placeholder:"Search packages...",value:p,onChange:e=>x(e.target.value),style:{paddingLeft:"40px"}})]})}),(0,n.jsxs)("select",{className:"input",style:{width:"auto",minWidth:"150px"},value:g,onChange:e=>m(e.target.value),children:[(0,n.jsx)("option",{value:"all",children:"All Status"}),(0,n.jsx)("option",{value:"pending",children:"Pending"}),(0,n.jsx)("option",{value:"geocoded",children:"Geocoded"}),(0,n.jsx)("option",{value:"routed",children:"Routed"}),(0,n.jsx)("option",{value:"verification_needed",children:"Need Verification"}),(0,n.jsx)("option",{value:"failed",children:"Failed"})]}),(0,n.jsxs)("button",{className:"btn btn-secondary",onClick:y,disabled:a,children:[(0,n.jsx)(o.Z,{size:16,className:a?"loading":""}),"Refresh"]}),(0,n.jsxs)("button",{className:"btn btn-primary",onClick:()=>v(!0),children:[(0,n.jsx)(u,{size:16}),"Ingest Package"]})]})}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("div",{className:"card-header",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"card-title",children:"All Packages"}),(0,n.jsxs)("p",{className:"card-subtitle",children:["Showing ",j.length," of ",e.length," packages"]})]})}),(0,n.jsx)(r.Z,{packages:j})]}),f&&(0,n.jsx)(h,{onClose:()=>v(!1),onSuccess:()=>{v(!1),y()}})]})]})}function h(e){let{onClose:t,onSuccess:a}=e,[i,r]=(0,s.useState)({device_id:"web-console",package_id:"PKT".concat(Date.now()),ocr_text:"",ocr_confidence:.9,priority:"standard"}),[c,d]=(0,s.useState)(!1),[o,u]=(0,s.useState)("");async function p(e){if(e.preventDefault(),!i.ocr_text.trim()){u("Address text is required");return}try{d(!0),u(""),await (0,l.r7)(i),a()}catch(e){u(e instanceof Error?e.message:"Failed to ingest package")}finally{d(!1)}}return(0,n.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,n.jsxs)("div",{className:"card",style:{width:"500px",maxWidth:"90vw"},children:[(0,n.jsx)("div",{className:"card-header",children:(0,n.jsx)("h2",{className:"card-title",children:"Ingest New Package"})}),(0,n.jsxs)("form",{onSubmit:p,children:[(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{className:"input-label",children:"Package ID"}),(0,n.jsx)("input",{type:"text",className:"input",value:i.package_id,onChange:e=>r({...i,package_id:e.target.value})})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{className:"input-label",children:"Address Text (OCR)"}),(0,n.jsx)("textarea",{className:"input",rows:3,placeholder:"e.g., Jalan Merdeka 45 RT 02/RW 03, Kebayoran Lama, Jakarta Selatan 12220",value:i.ocr_text,onChange:e=>r({...i,ocr_text:e.target.value})})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{className:"input-label",children:"Priority"}),(0,n.jsxs)("select",{className:"input",value:i.priority,onChange:e=>r({...i,priority:e.target.value}),children:[(0,n.jsx)("option",{value:"standard",children:"Standard"}),(0,n.jsx)("option",{value:"high",children:"High"}),(0,n.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),o&&(0,n.jsx)("p",{style:{color:"var(--accent-red)",marginBottom:"16px"},children:o}),(0,n.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,n.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:t,children:"Cancel"}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:c,children:c?"Processing...":"Ingest Package"})]})]})]})})}},8476:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var n=a(7437),s=a(4322),i=a(2894),r=a(2442),l=a(9670),c=a(6142),d=a(9246);let o={pending:{label:"Pending",className:"badge-pending"},processing:{label:"Processing",className:"badge-processing"},parsed:{label:"Parsed",className:"badge-processing"},geocoded:{label:"Geocoded",className:"badge-geocoded"},routed:{label:"Routed",className:"badge-routed"},delivered:{label:"Delivered",className:"badge-geocoded"},verification_needed:{label:"Verify",className:"badge-verification"},failed:{label:"Failed",className:"badge-failed"}};function u(e){let{packages:t,compact:a,onSelect:u}=e;return 0===t.length?(0,n.jsxs)("div",{style:{padding:"40px",textAlign:"center",color:"var(--text-muted)"},children:[(0,n.jsx)(s.Z,{size:48,style:{marginBottom:"16px",opacity:.5}}),(0,n.jsx)("p",{children:"No packages found"})]}):(0,n.jsx)("div",{className:"table-container",children:(0,n.jsxs)("table",{className:"table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Package ID"}),!a&&(0,n.jsx)("th",{children:"Device"}),(0,n.jsx)("th",{children:"Address (OCR)"}),(0,n.jsx)("th",{children:"Confidence"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Time"}),!a&&(0,n.jsx)("th",{children:"Actions"})]})}),(0,n.jsx)("tbody",{children:t.map(e=>{let t=o[e.status]||o.pending,s=(100*e.ocr_confidence).toFixed(0),p=e.ocr_confidence<.7;return(0,n.jsxs)("tr",{onClick:()=>null==u?void 0:u(e),style:{cursor:u?"pointer":"default"},children:[(0,n.jsx)("td",{children:(0,n.jsx)("span",{style:{fontFamily:"monospace",fontSize:"13px"},children:e.package_id})}),!a&&(0,n.jsx)("td",{style:{color:"var(--text-secondary)"},children:e.device_id}),(0,n.jsx)("td",{children:(0,n.jsx)("div",{style:{maxWidth:a?"200px":"300px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"13px"},children:e.ocr_text})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:p?"var(--accent-orange)":"var(--accent-green)"},children:[p?(0,n.jsx)(i.Z,{size:14}):(0,n.jsx)(r.Z,{size:14}),(0,n.jsxs)("span",{children:[s,"%"]})]})}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:"badge ".concat(t.className),children:t.label})}),(0,n.jsx)("td",{style:{color:"var(--text-muted)",fontSize:"13px"},children:(0,d.Q)(new Date(e.created_at),{addSuffix:!0})}),!a&&(0,n.jsx)("td",{children:(0,n.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,n.jsx)("button",{className:"btn btn-icon btn-secondary",title:"View Details",children:(0,n.jsx)(l.Z,{size:16})}),(0,n.jsx)("button",{className:"btn btn-icon btn-secondary",title:"View on Map",children:(0,n.jsx)(c.Z,{size:16})})]})})]},e.id)})})]})})}},6652:function(e,t,a){"use strict";a.d(t,{Z:function(){return g}});var n=a(7437),s=a(1396),i=a.n(s),r=a(4033),l=a(5119),c=a(4322),d=a(6142),o=a(1961),u=a(1981),p=a(2457),h=a(9409);let x=[{id:"dashboard",label:"Dashboard",icon:l.Z,href:"/"},{id:"packages",label:"Packages",icon:c.Z,href:"/packages"},{id:"routes",label:"Routes",icon:d.Z,href:"/routes"},{id:"vehicles",label:"Vehicles",icon:o.Z,href:"/vehicles"},{id:"verification",label:"Verification",icon:u.Z,href:"/verification"},{id:"analytics",label:"Analytics",icon:p.Z,href:"/analytics"}];function g(e){let{active:t}=e,a=(0,r.usePathname)();return(0,n.jsxs)("aside",{className:"sidebar",children:[(0,n.jsx)("div",{style:{padding:"0 20px",marginBottom:"32px"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,n.jsx)("div",{style:{width:"40px",height:"40px",background:"var(--gradient-blue)",borderRadius:"var(--radius-md)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsx)(c.Z,{size:22,color:"white"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{style:{fontSize:"18px",fontWeight:"700"},children:"Paket"}),(0,n.jsx)("p",{style:{fontSize:"12px",color:"var(--text-muted)"},children:"Routing System"})]})]})}),(0,n.jsx)("nav",{children:(0,n.jsxs)("div",{style:{padding:"0 12px"},children:[(0,n.jsx)("p",{style:{fontSize:"11px",fontWeight:"600",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"1px",padding:"0 8px",marginBottom:"8px"},children:"Menu"}),x.map(e=>{let s=t===e.id||a===e.href,r=e.icon;return(0,n.jsxs)(i(),{href:e.href,style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",borderRadius:"var(--radius-md)",marginBottom:"4px",color:s?"var(--text-primary)":"var(--text-secondary)",background:s?"var(--bg-tertiary)":"transparent",transition:"var(--transition-fast)",position:"relative"},children:[s&&(0,n.jsx)("div",{style:{position:"absolute",left:0,top:"50%",transform:"translateY(-50%)",width:"3px",height:"24px",background:"var(--gradient-blue)",borderRadius:"0 4px 4px 0"}}),(0,n.jsx)(r,{size:20}),(0,n.jsx)("span",{style:{fontSize:"14px",fontWeight:s?"500":"400"},children:e.label})]},e.id)})]})}),(0,n.jsx)("div",{style:{position:"absolute",bottom:"20px",left:"0",right:"0",padding:"0 12px"},children:(0,n.jsxs)(i(),{href:"/settings",style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",borderRadius:"var(--radius-md)",color:"var(--text-secondary)",transition:"var(--transition-fast)"},children:[(0,n.jsx)(h.Z,{size:20}),(0,n.jsx)("span",{style:{fontSize:"14px"},children:"Settings"})]})})]})}},8222:function(e,t,a){"use strict";async function n(e,t){let a=await fetch("".concat("/api/v1").concat(e),{headers:{"Content-Type":"application/json",...null==t?void 0:t.headers},...t});if(!a.ok)throw Error((await a.json().catch(()=>({detail:"Request failed"}))).detail||"HTTP ".concat(a.status));return a.json()}async function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{return(await n("/ingest?limit=".concat(e))).packages||[]}catch(t){return function(e){let t=["pending","geocoded","routed","verification_needed"],a=["Jakarta Selatan","Jakarta Pusat","Jakarta Barat","Jakarta Timur","Jakarta Utara"],n=["Jalan Sudirman","Jalan Thamrin","Jalan Gatot Subroto","Jalan Rasuna Said","Jalan Kemang"];return Array.from({length:e},(e,s)=>{let i=t[Math.floor(Math.random()*t.length)],r=a[Math.floor(Math.random()*a.length)],l=n[Math.floor(Math.random()*n.length)];return{id:"pkg-".concat(s+1),package_id:"PKT".concat(new Date().getFullYear()).concat(String(s+1).padStart(6,"0")),device_id:"scanner-".concat(Math.floor(20*Math.random())+1),ocr_text:"".concat(l," No. ").concat(Math.floor(200*Math.random())+1,", RT 0").concat(Math.floor(9*Math.random())+1,"/RW 0").concat(Math.floor(9*Math.random())+1,", ").concat(r),ocr_confidence:.3*Math.random()+.65,status:i,priority:Math.random()>.8?"high":"standard",created_at:new Date(Date.now()-864e5*Math.random()).toISOString()}})}(e)}}async function i(e){return n("/ingest/ocr-text",{method:"POST",body:JSON.stringify(e)})}async function r(e){return(await n("/address/parse",{method:"POST",body:JSON.stringify({raw_text:e,apply_corrections:!0})})).address}async function l(e){try{return(await n("/routes".concat(e?"?planned_date=".concat(e):""))).routes||[]}catch(e){return[{id:"route-1",vehicle_id:"V001",vehicle_code:"V001",driver_name:"Driver A",planned_date:new Date().toISOString().split("T")[0],status:"planned",total_distance_km:25.4,total_time_minutes:180,total_stops:12,stops:[{sequence:0,lat:-6.2088,lon:106.8456,address_summary:"Depot",status:"completed"},{sequence:1,package_id:"PKT001",lat:-6.225,lon:106.795,address_summary:"Jalan Sudirman 45",status:"pending"},{sequence:2,package_id:"PKT002",lat:-6.235,lon:106.78,address_summary:"Jalan Thamrin 12",status:"pending"},{sequence:3,package_id:"PKT003",lat:-6.215,lon:106.82,address_summary:"Jalan Gatot Subroto 78",status:"pending"}]},{id:"route-2",vehicle_id:"V002",vehicle_code:"V002",driver_name:"Driver B",planned_date:new Date().toISOString().split("T")[0],status:"planned",total_distance_km:18.7,total_time_minutes:150,total_stops:8,stops:[{sequence:0,lat:-6.2088,lon:106.8456,address_summary:"Depot",status:"completed"},{sequence:1,package_id:"PKT004",lat:-6.18,lon:106.83,address_summary:"Jalan Kemang 33",status:"pending"},{sequence:2,package_id:"PKT005",lat:-6.19,lon:106.85,address_summary:"Jalan Rasuna Said 99",status:"pending"}]}]}}async function c(e){return n("/routes/optimize",{method:"POST",body:JSON.stringify(e)})}async function d(){try{await n("/health/ready");let e=await s(200);return{total_packages:e.length,pending_packages:e.filter(e=>"pending"===e.status).length,geocoded_packages:e.filter(e=>"geocoded"===e.status).length,routed_packages:e.filter(e=>"routed"===e.status).length,verification_needed:e.filter(e=>"verification_needed"===e.status).length,total_routes_today:0,active_vehicles:3,avg_confidence:e.reduce((e,t)=>e+t.ocr_confidence,0)/e.length||0}}catch(e){return{total_packages:156,pending_packages:12,geocoded_packages:89,routed_packages:45,verification_needed:10,total_routes_today:8,active_vehicles:5,avg_confidence:.87}}}a.d(t,{Cy:function(){return r},H7:function(){return l},ZS:function(){return s},mP:function(){return d},r7:function(){return i},x$:function(){return c}})}},function(e){e.O(0,[387,522,971,938,744],function(){return e(e.s=296)}),_N_E=e.O()}]);