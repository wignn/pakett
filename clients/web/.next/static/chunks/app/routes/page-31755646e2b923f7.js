(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[316],{4280:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(2898).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},7347:function(e,s,t){Promise.resolve().then(t.bind(t,2377))},2377:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var a=t(7437),i=t(2265),l=t(6652),n=t(5744),c=t(8222),r=t(4280),d=t(2898);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,d.Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),x=(0,d.Z)("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);var h=t(1961),m=t(6142);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let p=(0,d.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);function u(){let[e,s]=(0,i.useState)([]),[t,d]=(0,i.useState)(!0),[u,v]=(0,i.useState)(!1),[j,g]=(0,i.useState)(null),[y,f]=(0,i.useState)(new Date().toISOString().split("T")[0]);async function N(){try{d(!0);let e=await (0,c.H7)(y);s(e)}catch(e){console.error("Failed to load routes:",e)}finally{d(!1)}}async function b(){try{v(!0);let e=await (0,c.x$)({planned_date:y,max_solve_time_seconds:120,balance_routes:!0});g(e),await N()}catch(e){console.error("Optimization failed:",e)}finally{v(!1)}}(0,i.useEffect)(()=>{N()},[y]);let _=e.reduce((e,s)=>e+s.total_distance_km,0),k=e.reduce((e,s)=>e+s.total_time_minutes,0),z=e.reduce((e,s)=>e+s.total_stops,0);return(0,a.jsxs)("div",{className:"layout",children:[(0,a.jsx)(l.Z,{active:"routes"}),(0,a.jsxs)("main",{className:"main-content",children:[(0,a.jsxs)("div",{className:"page-header",children:[(0,a.jsx)("h1",{className:"page-title",children:"Route Optimization"}),(0,a.jsx)("p",{className:"page-description",children:"Optimize and manage delivery routes using VRP algorithms"})]}),(0,a.jsx)("div",{className:"card",style:{marginBottom:"24px"},children:(0,a.jsxs)("div",{style:{display:"flex",gap:"16px",alignItems:"center",flexWrap:"wrap"},children:[(0,a.jsxs)("div",{className:"input-group",style:{marginBottom:0},children:[(0,a.jsx)("label",{className:"input-label",children:"Planned Date"}),(0,a.jsx)("input",{type:"date",className:"input",value:y,onChange:e=>f(e.target.value),style:{width:"180px"}})]}),(0,a.jsx)("div",{style:{flex:1}}),(0,a.jsxs)("button",{className:"btn btn-secondary",onClick:N,disabled:t,children:[(0,a.jsx)(r.Z,{size:16,className:t?"loading":""}),"Refresh"]}),(0,a.jsxs)("button",{className:"btn btn-primary",onClick:b,disabled:u,children:[(0,a.jsx)(o,{size:16}),u?"Optimizing...":"Run Optimization"]})]})}),j&&(0,a.jsx)("div",{className:"card",style:{marginBottom:"24px",background:j.success?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",borderColor:j.success?"var(--accent-green)":"var(--accent-red)"},children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,a.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:j.success?"var(--accent-green)":"var(--accent-red)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(x,{size:24,color:"white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{style:{margin:0},children:j.success?"Optimization Complete!":"Optimization Failed"}),(0,a.jsx)("p",{style:{margin:"4px 0 0",color:"var(--text-secondary)"},children:j.success?"Created ".concat(j.total_vehicles_used," routes for ").concat(j.total_packages," packages in ").concat(j.optimization_time_ms,"ms"):j.error})]}),(0,a.jsx)("button",{className:"btn btn-secondary btn-sm",style:{marginLeft:"auto"},onClick:()=>g(null),children:"Dismiss"})]})}),(0,a.jsxs)("div",{className:"stats-grid",style:{marginBottom:"24px"},children:[(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("div",{className:"stat-icon purple",children:(0,a.jsx)(h.Z,{size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"stat-value",children:e.length}),(0,a.jsx)("div",{className:"stat-label",children:"Active Routes"})]})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("div",{className:"stat-icon blue",children:(0,a.jsx)(m.Z,{size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"stat-value",children:z}),(0,a.jsx)("div",{className:"stat-label",children:"Total Stops"})]})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("div",{className:"stat-icon green",children:(0,a.jsx)(x,{size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"stat-value",children:[_.toFixed(1)," km"]}),(0,a.jsx)("div",{className:"stat-label",children:"Total Distance"})]})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("div",{className:"stat-icon orange",children:(0,a.jsx)(p,{size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"stat-value",children:[Math.round(k/60),"h ",k%60,"m"]}),(0,a.jsx)("div",{className:"stat-label",children:"Est. Duration"})]})]})]}),(0,a.jsxs)("div",{className:"grid-2",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsx)("h2",{className:"card-title",children:"Route Map"})}),(0,a.jsx)(n.Z,{routes:e,height:500})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsx)("h2",{className:"card-title",children:"Routes List"})}),0===e.length?(0,a.jsxs)("div",{style:{padding:"40px",textAlign:"center",color:"var(--text-muted)"},children:[(0,a.jsx)(h.Z,{size:48,style:{marginBottom:"16px",opacity:.5}}),(0,a.jsx)("p",{children:"No routes for this date"}),(0,a.jsx)("p",{style:{fontSize:"14px",marginTop:"8px"},children:"Run optimization to create routes"})]}):(0,a.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:e.map((e,s)=>{var t;return(0,a.jsxs)("div",{style:{padding:"16px",background:"var(--bg-tertiary)",borderRadius:"var(--radius-md)",border:"1px solid var(--border-primary)"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"},children:[(0,a.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:["#3b82f6","#22c55e","#f97316","#a855f7","#ec4899"][s%5],display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"600",fontSize:"14px"},children:(null===(t=e.vehicle_code)||void 0===t?void 0:t[1])||s+1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:e.vehicle_code||e.vehicle_id}),e.driver_name&&(0,a.jsx)("span",{style:{color:"var(--text-muted)",marginLeft:"8px"},children:e.driver_name})]}),(0,a.jsx)("span",{className:"badge badge-".concat("planned"===e.status?"processing":"geocoded"),style:{marginLeft:"auto"},children:e.status})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"24px",fontSize:"14px",color:"var(--text-secondary)"},children:[(0,a.jsxs)("span",{children:[(0,a.jsx)(m.Z,{size:14,style:{marginRight:"4px"}}),e.total_stops," stops"]}),(0,a.jsxs)("span",{children:[(0,a.jsx)(x,{size:14,style:{marginRight:"4px"}}),e.total_distance_km.toFixed(1)," km"]}),(0,a.jsxs)("span",{children:[(0,a.jsx)(p,{size:14,style:{marginRight:"4px"}}),e.total_time_minutes," min"]})]})]},e.id)})})]})]})]})]})}}},function(e){e.O(0,[387,740,971,938,744],function(){return e(e.s=7347)}),_N_E=e.O()}]);